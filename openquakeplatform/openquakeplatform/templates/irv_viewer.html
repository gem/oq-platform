<!--
Copyright (c) 2014, GEM Foundation.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/agpl.html>.
-->
{% extends "data_viewer_base.html" %}

{% block title %}
Explore - {{block.super}}
{% endblock %}

{% block body_outer %}
{% include "base_map_options.html" %}

<button type="button" id="load-project">Load Project</button>
<button type="button" id="help">Help</button>

<div id="loadProjectDialog" title="Load Project">
  <form id="tile-form-list">
    <br>Category:<br>
    <select id="layer-category">
    </select>
    <br>Project:<br>
    <select id="layer-list">
    </select><br>
    <input type="button" id="addLayer" value="Add Layer">
    <input type="button" id="removeLayer" value="Remove Layer">
  </form>
</div>

<div id="helpDialog" title="Help" style="overflow: hidden;">
    <h1><center>Integrated Risk and Vulnerability Viewer</center></h1>

    <br>
    <h2><center>About</center></h2>

    <p>The Integrated Risk and Vulnerability Viewer is an interactive map created by the GEM Foundation that can be used to explore and interact with social vulnerability indicators. Within the application users can load a project that has been created using the GEM SVIR QGIS plugin. Users are then able to modify the indicator weights, these new values directly affect the charts that can be viewed by clicking regions on the map.</p>
    <br>

    <ul>
      <li><h3>Layers:</h3>
        <dl>Alternative base maps can be selected on the top left of the toolbar</dl>
        <dl>Each layer that is added to the map gets added to the layer controller <img src="{{ STATIC_URL }}/Leaflet/dist/images/layers.png" alt="controller image" style="width:26px;height:26px">, from the controller layers can be turned on and off</dl>
      </li>

      <li><h3>Loading layers into the map:</h3>
        <dl>Select 'Load Project', from the respective dialog one can choose to load a project into the map</dl>

        <dl>Once a project has been selected and loaded, the map view will zoom to the location of the project map layer</dl>

        <dl>To view and modify the project definition tree, select the Project Def tab. The weights can now be modified by clicking on a name within the 'tree branch' of the project definition. All of the weight values for a single tree branch will be normalized to a sum equal to 1. These weights will be applied to the charts</dl>

      </li>
      <li><h3>The Charts:</h3>
        <dl>Charts can be rendered for IRI, Category and Primary indicators of each region of the project. To render a chart, simply click on the respective chart tab, then select a region on the map</dl>

      <li><h3>Attribution:</h3>
      <!-- TODO add data attribution link
        <dl><b>Data: </b> Information about the data accesable in this applicaiton can be found at <a style="color: rgb(0,102,204)" href="https://hazardwiki.openquake.org/hazard_models">here</a></dl>
        -->
        <dl><b>Basemaps: <br></b><a style="color: rgb(0,102,204)" href="http://visibleearth.nasa.gov/view_cat.php?categoryID=1484">Blue Marble</a>, Source: NASA Earth Observatory/NOAA NGDC
        <br>
        <a style="color: rgb(0,102,204)" href="http://msdn.microsoft.com/en-us/library/dd877180.aspx">Bing Maps</a>
        <br>
        <a style="color: rgb(0,102,204)" href="http://developer.mapquest.com/web/tools/getting-started/platform/licensed-vs-open">MapQuest</a>
        <a style="color: rgb(0,102,204)" href="http://www.openstreetmap.org/copyright">OpenStreetMaps</a>
        <br>
        <br>
        <b>Graph: </b><a style="color: rgb(0,102,204)" href="http://d3js.org/">d3.js</a> by <a style="color: rgb(0,102,204)" href="http://bost.ocks.org/mike/">Mike Bostock</a>was used to generate the hazard and risk plots
        <br>
        <br>
        <b>Map: </b><a style="color: rgb(0,102,204)" href="http://leafletjs.com/">Leaflet.js</a> was used to generate the web maps
        <br>
        </dl>

      </li>
    </ul>
  </div>

<div id="projectDefWeightDialog" title="Project Definition">
</div>

<div id="warning-duplicate" title="Woops!" class="ui-helper-hidden">
    <p>This layer has already been added to the map</p>
</div>

<div id="warning-no-layer" title="Woops!" class="ui-helper-hidden">
    <p>This layer in not loaded in the map</p>
</div>

{{block.super}}
<link rel="stylesheet" href="{{ STATIC_URL }}css/irv_viewer.css" />

{% endblock %}


{% block extra_script %}
    {{block.super}}
    <!-- Category tags-->
<div id="categoryTabs">
  <ul>
    <li id="1" ><a href="#project-def">Project Def</a></li>
    <li id="2"><a href="#iri-chart">IRI Chart</a></li>
    <li id="3"><a href="#cat-chart">Category Chart</a></li>
    <li id="4"><a href="#primary-tab">Primary Chart</a></li>

  </ul>

  <div id="project-def">
    <div id="projectDefDialog" title="Project Definition">
    </div>
  </div>
  <div id="iri-chart"></div>
  <div id="cat-chart"></div>
  <div id="primary-tab">
    <div id="primary-limit">
      <p>
        <label for="outlier-limit"> Outlier Break Point </label>
        <input id="outlier-limit" name="outlier-limit" value="0.7">
      </p>
    </div>
    <div id="primary-chart"></div>
  </div>

  <!-- TODO fix this-->
  <div id="empty" style="height:500px;">
  </div>

</div>
    <script src="{{ STATIC_URL }}js/irv_viewer.js"></script>
    <script src="{{ STATIC_URL }}js/irv_viewer_d3_tree.js"></script>
    <script src="{{ STATIC_URL }}js/irv_viewer_PCP_IRI.js"></script>
    <script src="{{ STATIC_URL }}js/irv_viewer_PCP_category.js"></script>
    <script src="{{ STATIC_URL }}js/irv_viewer_PCP_primary.js"></script>
    <script src="{{ STATIC_URL }}js/base_map_options.js"></script>
    
{% endblock extra_script %}
