#!/bin/bash
fname="$1"
NL="
"
IFS="
"
first=""
second=""
for cla in $(cat "$fname" | grep '^class.*models\.Model.*' | sed 's/^class //g;s/(.*//g'); do
    first="${first}${NL}from models import ${cla}"
    second="${second}${NL}admin.site.register(${cla})"
done

echo "from django.contrib import admin"
echo "$first"
echo "$second"

cat <<EOF


class CC_PredictorVarInline(admin.StackedInline):
    model = CC_PredictorVar
    fk_name = 'capacity_curve_func'


class CapacityCurveFuncAdmin(admin.ModelAdmin):
    inlines = [
        CC_PredictorVarInline
    ]


admin.site.unregister(CapacityCurveFunc)
admin.site.register(CapacityCurveFunc, CapacityCurveFuncAdmin)
EOF
