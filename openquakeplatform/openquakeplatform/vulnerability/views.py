from django.http import HttpResponse

from django.http import Http404
from django.shortcuts import render_to_response
from models import GeneralInformation
from django.core import serializers


def index(request, **kwargs):
    print dir(kwargs)
    return HttpResponse("Hello world!")


def show_general_information(request, gen_info_id):
    try:
        #gi = GeneralInformation.objects.get(pk=gen_info_id)
        gi = GeneralInformation.objects.select_related().get(pk=gen_info_id)
        #gi = GeneralInformation.objects.filter(id=gen_info_id)
    except GeneralInformation.DoesNotExist:
        raise Http404
    gi_json = ''
    print dir(gi)
    #print dir(gi.fragility_func)
    #print dir(gi.fragility_func.analytical_model_info)
    #print gi.fragility_func.analytical_model_info.models_num
    gi_json = serializers.serialize(
        "json",
        [gi],
        indent=4,
        choices=True,
        relations={
            'fragility_func': {
                'relations': {
                    'analytical_model_info': {
                        'relations': ('analysis_type', )
                    },
                    'empirical_model_info': {},
                    'stat_info': {
                        'relations': ('stat_model',
                                      'stat_model_fitting_method',
                                      'model_fitting_method_assumption',
                                      'fit_assessment_goodness',
                                      'proc_constr_conf_int',
                                      'proc_constr_pred_int', )
                    },
                    'predictor_var': {},
                    'func_distr_frag_discr': {},
                    'func_distr_frag_cont': {
                        'relations': ('func_distr_shape', )
                    },
                    'engineering_demand_par': {},
                },
            },
            'vulnerability_func': {
                'relations': {
                    'analytical_model_info': {
                        'relations': ('analysis_type', )
                    },
                    'empirical_model_info': {},
                    'stat_info': {
                        'relations': ('stat_model',
                                      'stat_model_fitting_method',
                                      'model_fitting_method_assumption',
                                      'fit_assessment_goodness',
                                      'proc_constr_conf_int',
                                      'proc_constr_pred_int', )
                    },
                    'predictor_var': {},
                    'func_distr_vuln_discr': {},
                    'func_distr_vuln_cont': {
                        'relations': ('func_distr_shape', )
                    },
                }
            },
            'damage_to_loss_func': {
                'relations': {
                    'analytical_model_info': {
                        'relations': ('analysis_type', )
                    },
                    'empirical_model_info': {},
                    'stat_info': {
                        'relations': ('stat_model',
                                      'stat_model_fitting_method',
                                      'model_fitting_method_assumption',
                                      'fit_assessment_goodness',
                                      'proc_constr_conf_int',
                                      'proc_constr_pred_int', )
                    },
                    'func_distr_dtl_discr': {
                        'relations': ('func_distr_shape', )
                    },
                }
            },
            'capacity_curve_func': {
                'relations': {
                    'analytical_model_info': {
                        'relations': ('analysis_type', )
                    },
                    'stat_info': {
                        'relations': ('stat_model',
                                      'stat_model_fitting_method',
                                      'model_fitting_method_assumption',
                                      'fit_assessment_goodness',
                                      'proc_constr_conf_int',
                                      'proc_constr_pred_int', )
                    },
                    'cc_predictor_var': {
                        'relations': ('engineering_demand_param', )
                    },
                }
            },
            'taxonomy_type': {}
        })
    #return HttpResponse(gi_json)
    return render_to_response(
        'vulnerability/show_general_information.html',
        {'general_information': gi_json})
